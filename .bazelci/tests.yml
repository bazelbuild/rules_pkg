common: &common
  working_directory: /workdir/pkg

default_tests: &default_tests
  - "..."

win_tests: &win_tests
  - "..."
  - "-//distro/..."
  - "-//legacy/tests/rpm/..."
  - "-//tests:make_rpm_test"
  - "-//tests:package_naming_aggregate_test"
  - "-//tests:path_test"
  - "-//tests/mappings/filter_directory/..."
  - "-//tests/rpm/..."
  - "-//tests/install/..."


# rpmbuild(8) is not available on most platforms
skip_rpm: &skip_rpm
  - "-//tests/rpm/..."
  - "-//legacy/tests/rpm/..."


tasks:
  lts_centos7:
    platform: centos7
    <<: *common
    test_targets:
      <<: *default_tests
      <<: *skip_rpm
  lts_ubuntu1804:
    platform: ubuntu1804
    <<: *common
    test_targets:
      <<: *default_tests
      <<: *skip_rpm
    build_targets:
      - "//distro:distro"
      - "//distro:relnotes"
  lts_macos:
    platform: macos
    <<: *common
    test_targets:
      <<: *default_tests
      <<: *skip_rpm
  lts_windows:
    platform: windows
    <<: *common
    test_targets:
      <<: *win_tests
      <<: *skip_rpm
