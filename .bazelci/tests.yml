common: &common
  working_directory: /workdir/pkg

default_tests: &default_tests
  - "..."
  - "-//tests/rpm/..."
  - "-//legacy/tests/rpm/..."


# rpmbuild(8) is not available on most platforms
skip_rpm: &skip_rpm
  - "-//tests/rpm/..."
  - "-//legacy/tests/rpm/..."

win_tests: &win_tests
  test_targets:
    - "..."
    - "-//distro/..."
    - "-//legacy/tests/rpm/..."
    - "-//tests:make_rpm_test"
    - "-//tests:package_naming_aggregate_test"
    - "-//tests:path_test"
    - "-//tests/mappings/filter_directory/..."
    - "-//tests/rpm/..."
    - "-//tests/install/..."


tasks:
  lts_centos7:
    platform: centos7
    <<: *common
    <<: *default_tests
  lts_ubuntu1804:
    platform: ubuntu1804
    <<: *common
    <<: *default_tests
    build_targets:
      - "//distro:distro"
      - "//distro:relnotes"
  lts_macos:
    platform: macos
    <<: *common
    <<: *default_tests
  lts_windows:
    platform: windows
    <<: *common
    <<: *win_tests
